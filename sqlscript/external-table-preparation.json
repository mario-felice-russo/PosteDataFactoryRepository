{
	"name": "external-table-preparation",
	"properties": {
		"content": {
			"query": "\n/* Article from */\n-- https://docs.microsoft.com/it-it/azure/synapse-analytics/quickstart-sql-on-demand\n\n\nCREATE DATABASE [mg3-db];\nGO\n\n\n/*\nCREATE DATABASE SCOPED CREDENTIAL ASCDL\nWITH\n    IDENTITY = '5cf8cce9-e209-41bc-a34e-900a8d5d41a7@https://login.microsoftonline.com/1a6535bc-633b-4af1-b532-fa48559ad835/oauth2/token'\n    ,SECRET = 'PC5F.-aBTr_.~6dav30P54eEV9tSdpK6qh'\n;\n*/\n\n\nCREATE MASTER KEY ENCRYPTION BY PASSWORD = 'mg3M@y67-21';\n-- sv=2020-04-08&ss=btqf&srt=sco&st=2021-03-31T08%3A06%3A20Z&se=2021-04-01T08%3A06%3A20Z&sp=rwdxftlacup&sig=OoFu%2FAsQIVAgt%2Fn39ucwcLSo5V9qInatu9pQBphHBSk%3D\nCREATE DATABASE SCOPED CREDENTIAL sqlondemand\nWITH\n\tIDENTITY = 'SHARED ACCESS SIGNATURE',\n\tSECRET = 'sv=2020-04-08&ss=btqf&srt=sco&st=2021-03-31T08%3A06%3A20Z&se=2021-04-01T08%3A06%3A20Z&sp=rwdxftlacup&sig=OoFu%2FAsQIVAgt%2Fn39ucwcLSo5V9qInatu9pQBphHBSk%3D';\nGO\n\n\n-- Secret ServicePrincipal <PC5F.-aBTr_.~6dav30P54eEV9tSdpK6qh>\n\nCREATE EXTERNAL DATA SOURCE BlobStorage -- Polybase\nWITH (\n\tTYPE = HADOOP,\n\tCREDENTIAL = sqlondemand,\n\tLOCATION = 'abfss://mg3synapsefilesystem@mg3synapsestorage.dfs.core.windows.net/mg3synapsefilesystem/'\n);\n\n-- abfss://mg3synapsefilesystem@mg3synapsestorage.dfs.core.windows.net/datasets_33080_1320127_car+data.csv\n\nCREATE EXTERNAL FILE FORMAT CsvFileFormat\nWITH (\n\tFORMAT_TYPE = DELIMITEDTEXT,\n\tFORMAT_OPTIONS (\n\t\tFIELD_TERMINATOR = ',',\n\t\tSTRING_DELIMITER = '\"',\n\t\tUSE_TYPE_DEFAULT = FALSE\n\t)\n);\n\nCREATE EXTERNAL TABLE [dbo].[CarData]\n(\n\t Car_Name VARCHAR(50),\n\t Year INT,\n\t Selling_Price FLOAT,\n\t Present_Price FLOAT,\n\t Kms_Driven FLOAT,\n\t Fuel_Type VARCHAR(20),\n\t Seller_Type VARCHAR(20),\n\t Transmission VARCHAR(20),\n\t Owner INT\n)\nWITH\n(\n\tLOCATION = 'abfss://mg3synapsefilesystem@mg3synapsestorage.dfs.core.windows.net/datasets_33080_1320127_car+data.csv',\n\tDATA_SOURCE = BlobStorage,\n\tFILE_FORMAT = CsvFileFormat\n);\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"poolName": "Built-in",
				"databaseName": "mg3-db"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}